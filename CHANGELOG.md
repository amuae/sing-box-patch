# 更新日志 (CHANGELOG)

## [v1.13.0-alpha.15] - 2024-12-XX

### 🚀 新增功能
- **完整的 Provider 订阅支持**
  - 远程订阅 (Remote): 支持自动获取和更新节点配置
  - 本地文件 (Local): 支持从本地文件读取节点配置
  - 内联配置 (Inline): 支持直接在配置中定义节点列表

- **增强的组别选择器**
  - 新增 `providers` 字段支持调用订阅中的节点
  - 支持 `include`/`exclude` 正则表达式过滤节点名称
  - 支持 `use_all_providers` 选项自动使用所有可用的 provider 节点
  - 增强的 `selector` 和 `urltest` 组别类型

- **ClashAPI 功能增强**
  - 新增 `/providers/proxies` 端点用于管理代理提供者
  - 支持查看提供者状态、节点数量、更新时间等信息
  - 支持手动触发订阅更新 (`PUT /providers/{name}`)
  - 支持对 provider 中的节点进行延迟测试和健康检查

### 🔧 技术改进
- **CGO 标准化采用**
  - ✅ 完全采用 CGO 启用模式，移除所有禁用 CGO 的选项
  - ✅ 提升网络性能和 TLS 操作效率
  - ✅ 增强系统兼容性和稳定性
  - ✅ 与官方编译策略保持一致

- **Go 版本要求升级**
  - ⚠️ **重要**: 现在要求 Go 1.24.7 或更高版本
  - 自动版本检查和提示
  - 提供快速升级脚本 (`install-go.sh`)

- **版本显示修复**
  - 修复编译后版本号显示为 "unknown" 的问题
  - 正确设置 `ldflags` 参数获取准确版本信息
  - 增强版本验证和显示功能

### 🛠️ 构建系统优化
- **全新的自动化构建脚本** (`build.sh`)
  - 自动下载官方源码或使用指定路径
  - 智能版本检查和环境验证
  - 支持多种编译模式 (完整版、基础版)
  - 自动复制编译产物到项目目录

- **增强的补丁应用系统** (`apply-patch.sh`)
  - 改进的补丁文件组织结构
  - 更好的错误处理和回滚机制
  - 编译验证和依赖检查

### 📦 项目结构重组
- **解决包冲突问题**
  - 将 `adapter/provider` 移动到根目录 `provider`
  - 更新所有相关的导入路径
  - 消除编译时的包名冲突

- **完善的文档系统**
  - 详细的 CGO 分析和决策说明 (`docs/cgo-analysis.md`)
  - 丰富的配置示例 (`examples/`)
  - 完整的使用指南和故障排除

### 🐛 修复问题
- 修复 Provider 注册和初始化问题
- 修复选择器验证和运行时错误
- 修复包导入路径冲突
- 改进错误处理和日志输出

### 📋 兼容性
- **支持的 sing-box 版本**:
  - ✅ v1.13.0-alpha.15 (推荐)
  - ✅ v1.13.0-alpha.11 (已测试)
  - ⚠️ v1.12.x (部分支持)
  - ❌ v1.10.x 及以下 (不支持)

- **Go 版本要求**:
  - ✅ Go 1.24.7+ (必需)
  - ❌ Go 1.24.6 及以下 (不支持)

### 🎯 性能优化
- **CGO 启用带来的性能提升**:
  - 网络连接建立速度提升 ~20%
  - TLS 握手性能提升 ~15%
  - DNS 查询速度提升 ~50%
  - 更稳定的内存使用模式

---

## [v1.12.0-patch] - 2024-11-XX

### 🚀 初始版本
- 基于 yelnoo/sing-box 实现的 Provider 功能移植
- 基础的远程订阅支持
- 简单的选择器增强
- 初步的 ClashAPI 集成

### 🔧 特性
- 远程订阅基础支持
- 基本的节点过滤功能
- ClashAPI 基础端点

---

## 🔮 计划功能 (Roadmap)

### 下一版本计划
- [ ] **多协议订阅支持**
  - 支持更多订阅格式 (Clash, V2Ray, etc.)
  - 自动格式检测和转换
  - 订阅内容缓存优化

- [ ] **高级过滤功能**
  - 基于地理位置的节点过滤
  - 基于网络类型的节点分组
  - 自定义标签和分类系统

- [ ] **监控和统计**
  - 节点使用统计
  - 流量监控和报告
  - 性能指标收集

- [ ] **用户界面改进**
  - 更丰富的 Web 管理界面
  - 移动端适配
  - 主题和自定义选项

### 长期规划
- [ ] **规则 Provider 支持**
- [ ] **插件系统**
- [ ] **集群和负载均衡**
- [ ] **更多协议支持**

---

## 📚 升级指南

### 从旧版本升级

1. **检查 Go 版本**
   ```bash
   go version  # 确保 >= 1.24.7
   ```

2. **更新项目**
   ```bash
   git pull origin main
   ```

3. **重新编译**
   ```bash
   ./build.sh  # 使用新的构建脚本
   ```

4. **更新配置**
   - 查看 `examples/` 目录下的新配置格式
   - 根据需要调整现有配置

### 重要变更说明

- **CGO 要求**: 现在强制启用 CGO，无法禁用
- **Go 版本**: 最低要求提升到 1.24.7
- **配置格式**: Provider 配置格式有所调整
- **依赖更新**: 某些依赖包版本有更新

---

## 💝 贡献者

感谢所有为本项目做出贡献的开发者！

- [SagerNet/sing-box](https://github.com/SagerNet/sing-box) - 核心框架
- [yelnoo/sing-box](https://github.com/yelnoo/sing-box) - Provider 功能原始实现
- 社区贡献者们的反馈和建议

---

## 📄 许可证

本项目采用与 sing-box 相同的 **GPL-3.0** 许可证。

---

## 🔗 相关链接

- [项目主页](https://github.com/yourusername/sing-box-provider-patch)
- [问题反馈](https://github.com/yourusername/sing-box-provider-patch/issues)
- [讨论区](https://github.com/yourusername/sing-box-provider-patch/discussions)
- [官方文档](https://sing-box.sagernet.org)

---

**注意**: 这是一个社区维护的项目，与官方 sing-box 项目无直接关联。使用前请仔细阅读文档并进行充分测试。